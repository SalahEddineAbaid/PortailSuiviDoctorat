<div class="forgot-password-container">
  <!-- Navbar -->
  <nav class="navbar">
    <div class="navbar-content">
      <div class="logo">
        <span class="logo-icon">ğŸ“</span>
        <span class="logo-text">Portail Doctoral</span>
      </div>
      <a routerLink="/login" class="btn-login">Se connecter</a>
    </div>
  </nav>

  <!-- Formulaire de demande de rÃ©initialisation -->
  <div class="forgot-password-card" *ngIf="mode === 'request'">
    <div class="card-header">
      <div class="icon">ğŸ”‘</div>
      <h1>Mot de passe oubliÃ© ?</h1>
      <p class="subtitle">Entrez votre adresse email pour recevoir un lien de rÃ©initialisation</p>
    </div>

    <form (ngSubmit)="onRequestReset()" class="forgot-password-form">
      
      <!-- Messages -->
      <div class="alert alert-error" *ngIf="errorMessage">
        <span class="alert-icon">âš ï¸</span>
        {{ errorMessage }}
      </div>

      <div class="alert alert-success" *ngIf="successMessage">
        <span class="alert-icon">âœ…</span>
        {{ successMessage }}
      </div>

      <!-- Email -->
      <div class="form-group">
        <label for="email">Adresse email</label>
        <div class="input-with-icon">
          <span class="input-icon">ğŸ“§</span>
          <input 
            type="email" 
            id="email" 
            name="email"
            [(ngModel)]="email"
            placeholder="exemple@domaine.com"
            required
            autocomplete="email">
        </div>
      </div>

      <!-- Bouton de soumission -->
      <button 
        type="submit" 
        class="btn-submit"
        [disabled]="isLoading">
        <span *ngIf="!isLoading">Envoyer le lien</span>
        <span *ngIf="isLoading">
          <span class="spinner"></span> Envoi en cours...
        </span>
      </button>
    </form>

    <!-- Lien retour -->
    <div class="back-link">
      <a routerLink="/login">â† Retour Ã  la connexion</a>
    </div>
  </div>

  <!-- Formulaire de rÃ©initialisation avec token -->
  <div class="reset-password-card" *ngIf="mode === 'reset'">
    <div class="card-header">
      <div class="icon">ğŸ”</div>
      <h1>RÃ©initialiser le mot de passe</h1>
      <p class="subtitle">Choisissez un nouveau mot de passe sÃ©curisÃ©</p>
    </div>

    <form (ngSubmit)="onResetPassword()" class="reset-password-form">
      
      <!-- Messages -->
      <div class="alert alert-error" *ngIf="errorMessage">
        <span class="alert-icon">âš ï¸</span>
        {{ errorMessage }}
      </div>

      <div class="alert alert-success" *ngIf="successMessage">
        <span class="alert-icon">âœ…</span>
        {{ successMessage }}
      </div>

      <!-- Nouveau mot de passe -->
      <div class="form-group">
        <label for="newPassword">Nouveau mot de passe</label>
        <div class="password-input">
          <span class="input-icon">ğŸ”’</span>
          <input 
            [type]="showPassword ? 'text' : 'password'"
            id="newPassword" 
            name="newPassword"
            [(ngModel)]="newPassword"
            (input)="validatePassword()"
            placeholder="Minimum 12 caractÃ¨res"
            required>
          <button 
            type="button" 
            class="toggle-password"
            (click)="togglePasswordVisibility()">
            {{ showPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
        
        <!-- CritÃ¨res du mot de passe -->
        <div class="password-requirements" *ngIf="newPassword">
          <p class="requirements-title">Le mot de passe doit contenir :</p>
          <ul>
            <li [class.valid]="hasValidLength()">
              âœ“ Entre 12 et 64 caractÃ¨res
            </li>
            <li [class.valid]="hasLowerCase()">
              âœ“ Au moins une lettre minuscule
            </li>
            <li [class.valid]="hasUpperCase()">
              âœ“ Au moins une lettre majuscule
            </li>
            <li [class.valid]="hasDigit()">
              âœ“ Au moins un chiffre
            </li>
            <li [class.valid]="hasSpecialChar()">
              âœ“ Au moins un caractÃ¨re spÃ©cial (@$!%*?&.)
            </li>
            <li [class.valid]="hasOnlyAllowedChars()">
              âœ“ Pas d'espaces ni de caractÃ¨res non autorisÃ©s
            </li>
          </ul>
        </div>
      </div>

      <!-- Confirmer le mot de passe -->
      <div class="form-group">
        <label for="confirmPassword">Confirmer le mot de passe</label>
        <div class="password-input">
          <span class="input-icon">ğŸ”’</span>
          <input 
            [type]="showConfirmPassword ? 'text' : 'password'"
            id="confirmPassword" 
            name="confirmPassword"
            [(ngModel)]="confirmPassword"
            placeholder="Retapez votre mot de passe"
            required>
          <button 
            type="button" 
            class="toggle-password"
            (click)="toggleConfirmPasswordVisibility()">
            {{ showConfirmPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
        <small class="match-indicator" *ngIf="confirmPassword" 
               [class.match]="newPassword === confirmPassword"
               [class.no-match]="newPassword !== confirmPassword">
          {{ newPassword === confirmPassword ? 'âœ“ Les mots de passe correspondent' : 'âœ— Les mots de passe ne correspondent pas' }}
        </small>
      </div>

      <!-- Bouton de soumission -->
      <button 
        type="submit" 
        class="btn-submit"
        [disabled]="isLoading">
        <span *ngIf="!isLoading">RÃ©initialiser le mot de passe</span>
        <span *ngIf="isLoading">
          <span class="spinner"></span> RÃ©initialisation en cours...
        </span>
      </button>
    </form>

    <!-- Lien retour -->
    <div class="back-link">
      <a routerLink="/login">â† Retour Ã  la connexion</a>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <p>Â© 2025 Portail Doctoral - Tous droits rÃ©servÃ©s</p>
  </div>
</div>
