<div class="directeur-dashboard" *ngIf="dashboardData$ | async as data">
  <!-- Header Section -->
  <div class="dashboard-header">
    <div class="welcome-section">
      <h1>Tableau de bord - Directeur de thèse</h1>
      <p class="welcome-message" *ngIf="currentUser">
        Bonjour {{ currentUser.FirstName }} {{ currentUser.LastName }}
      </p>
    </div>
    
    <div class="actions-section">
      <button 
        class="btn btn-primary" 
        (click)="onRefreshData()"
        title="Actualiser les données">
        <i class="fas fa-sync-alt"></i>
        Actualiser
      </button>
    </div>
  </div>

  <!-- Stats Overview -->
  <div class="stats-grid">
    <app-status-widget
      title="Doctorants encadrés"
      [value]="data.stats.totalDoctorants"
      icon="fas fa-users"
      color="primary">
    </app-status-widget>

    <app-status-widget
      title="Inscriptions en attente"
      [value]="data.stats.inscriptionsEnAttente"
      icon="fas fa-clock"
      color="warning"
      [clickable]="true">
    </app-status-widget>

    <app-status-widget
      title="Demandes de soutenance"
      [value]="data.stats.soutenancesEnAttente"
      icon="fas fa-graduation-cap"
      color="info"
      [clickable]="true">
    </app-status-widget>

    <app-status-widget
      title="Soutenances validées"
      [value]="data.stats.soutenancesValidees"
      icon="fas fa-check-circle"
      color="success">
    </app-status-widget>
  </div>

  <!-- Alerts Section -->
  <div class="alerts-section" *ngIf="data.alerts && data.alerts.length > 0">
    <h2>Alertes et notifications</h2>
    <div class="alerts-grid">
      <app-alert
        *ngFor="let alert of data.alerts"
        [type]="alert.type"
        [title]="alert.title"
        [message]="alert.message"
        [dismissible]="true">
      </app-alert>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="main-content">
    <!-- Doctorants List -->
    <div class="doctorants-section">
      <div class="section-header">
        <h2>Mes doctorants</h2>
        <span class="count-badge">{{ data.doctorants.length }}</span>
      </div>
      
      <app-doctorant-list
        [doctorants]="data.doctorants"
        [showActions]="true"
        (doctorantSelected)="onDoctorantSelected($event)">
      </app-doctorant-list>
    </div>

    <!-- Recent Activity -->
    <div class="activity-section">
      <div class="section-header">
        <h2>Activité récente</h2>
      </div>
      
      <div class="activity-list">
        <div 
          class="activity-item"
          *ngFor="let activity of data.recentActivity">
          <div class="activity-icon">
            <i [class]="activity.type === 'inscription' ? 'fas fa-user-plus' : 'fas fa-graduation-cap'"></i>
          </div>
          <div class="activity-content">
            <p class="activity-message">{{ activity.message }}</p>
            <span class="activity-date">{{ activity.date | date:'short' }}</span>
          </div>
        </div>
        
        <div class="no-activity" *ngIf="data.recentActivity.length === 0">
          <i class="fas fa-info-circle"></i>
          <p>Aucune activité récente</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <h2>Actions rapides</h2>
    <div class="actions-grid">
      <button class="action-card" routerLink="/inscriptions">
        <i class="fas fa-file-alt"></i>
        <span>Gérer les inscriptions</span>
      </button>
      
      <button class="action-card" routerLink="/soutenances">
        <i class="fas fa-graduation-cap"></i>
        <span>Gérer les soutenances</span>
      </button>
      
      <button class="action-card" routerLink="/doctorants">
        <i class="fas fa-users"></i>
        <span>Voir tous les doctorants</span>
      </button>
      
      <button class="action-card" routerLink="/rapports">
        <i class="fas fa-chart-bar"></i>
        <span>Rapports et statistiques</span>
      </button>
    </div>
  </div>
</div>

<!-- Loading State -->
<div class="loading-container" *ngIf="!(dashboardData$ | async)">
  <div class="loading-spinner">
    <i class="fas fa-spinner fa-spin"></i>
    <p>Chargement du tableau de bord...</p>
  </div>
</div>